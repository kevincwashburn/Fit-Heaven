<!DOCTYPE hmtl>
<html lang="en">

<head>
  <link rel="icon" href="https://cdn2.iconfinder.com/data/icons/fitness-and-sports/100/Fitnes-13-512.png">
  <title>Questionnaire: Fit Heaven</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale =1">
  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/lumen/bootstrap.min.css"> -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous" />
  <link href="https://fonts.googleapis.com/css2?family=Bitter:wght@400;700&family=Francois+One&display=swap"
    rel="stylesheet">
  <link href="stylesheets/style.css" rel="stylesheet">
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark">
    <a class="navbar-brand" href="./members.html">
      <img src="./images/logo.jpg">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="/members.html">Profile </a>
        </li>
        <li class="nav-item active">
          <a class="nav-link" href="/questionnaire.html">Filter Workouts</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/logout">Logout</a>
        </li>
      </ul>
    </div>
  </nav>


  <div id="questionBox" class="jumbotron">
    <form method="POST" action="members.html">
      <div class="first">
        <form action="POST" action="members.html">
          Gender:
          <br><br>
          <button type="button" class="btn-gender btn-primary">Male</button> <br><br>

          <button type="button" class="btn-gender btn-primary">Female</button> <br><br>
        </form>
      </div>

      <form style="text-align: left;">
        <div class="second" style="display: none;">

          <div class="col-auto">
            <div class="form-check mb-2" style="padding-left: 0px;">
              <h3 id="enterANumber" style="color: red; display: none;">Please enter a valid number!</h3>

              Please Enter Your Weight:

              </label>
            </div>
          </div>

          <div class=" form-row align-items-center">

            <div class="col-auto">


              <input type="number" class="form-control" required="required" id="inlineFormInputGroup" placeholder="">

            </div>
          </div>

          <div class="col-auto">
            <button type="submit" class="btn-weight btn-primary mb-2">Submit</button>
          </div>
      </form>
  </div>

  <div class="third" style="display: none;">
    <form id="atLeastOneTest">
      <h3 id="selectAtLeastOne" style="color: red; display: none;">Please select equipment category!</h3>
      Please select equipment categories you have access to: <br><br>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="bodyweight" id="defaultCheckBody" required>
        <label class="form-check-label" for="defaultCheck1">
          Bodyweight
        </label><br>
        <input class="form-check-input" type="checkbox" name="dumbbell" id="defaultCheckDumbbell" required>
        <label class="form-check-label" for="defaultCheck1">
          Dumbbell
        </label><br>
        <input class="form-check-input" type="checkbox" name="barbell" id="defaultCheckBarbell" required>
        <label class="form-check-label" for="defaultCheck1">
          Barbell
        </label><br>
        <input class="form-check-input" type="checkbox" name="cable/machine" id="defaultCheckCableMachine" required>
        <label class="form-check-label" for="defaultCheck1">
          Cable/Machine
        </label><br>

        <button type="submit" class="btn-equip btn-primary mb-2" id="questionnaireButton">Submit</button>

      </div>

  </div>
  </form>

  <div class="fourth" style="display:none;">
    Please select a level of fitness:
    <br><br>
    <button type="button" class="btn-level btn-primary">Beginner</button> <br>

    <button type="button" class="btn-level btn-primary">Moderate</button> <br>

    <button type="button" class="btn-level btn-primary">Advanced</button> <br>

  </div>

  <div class="fifth" style="display:none;">
    <form id="atLeastOne">
      <h3 id="selectAtLeastOneMuscle" style="color: red; display: none;">Please select a muscle!</h3>
      Please select which muscle(s) you want to work out: <br><br>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="chest" id="defaultCheck1" required>
        <label class="form-check-label" for="defaultCheck1">
          Chest
        </label><br>
        <input class="form-check-input" type="checkbox" name="back" id="defaultCheck1" required>
        <label class="form-check-label" for="defaultCheck1">
          Back
        </label><br>
        <input class="form-check-input" type="checkbox" name="legs" id="defaultCheck1" required>
        <label class="form-check-label" for="defaultCheck1">
          Legs
        </label><br>
        <input class="form-check-input" type="checkbox" name="shoulders" id="defaultCheck1" required>
        <label class="form-check-label" for="defaultCheck1">
          Shoulders
        </label><br>
        <input class="form-check-input" type="checkbox" name="biceps" id="defaultCheck1" required>
        <label class="form-check-label" for="defaultCheck1">
          Biceps
        </label><br>
        <input class="form-check-input" type="checkbox" name="triceps" id="defaultCheck1">
        <label class="form-check-label" for="defaultCheck1">
          Triceps
        </label><br>
        <input class="form-check-input" type="checkbox" name="abs" id="defaultCheck1">
        <label class="form-check-label" for="defaultCheck1">
          Abs
        </label><br>

        <button type="submit" class="btn-muscle btn-primary mb-2">Submit</button>

      </div>
    </form>
  </div>

  <div class="sixth" style="display: none; text-align: center;">
    <br><br><br><br>
    <button type="submit" class="btn-end btn-primary mb-2">Complete Questionnaire</button>
  </div>

  </form>
  </div>

  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/a4101eefc4.js" crossorigin="anonymous">
  </script>



  <script>

    let answers = [];
    let equipmentAnswers = [];
    let muscleAnswers = [];

    $(".btn-gender").click(function (event) {
      event.preventDefault();
      $(".first").hide();
      $(".second").show();
      answers.push(this.innerText);
      // console.log(answers);
    });

    $(".btn-weight").click(function (event) {
      event.preventDefault();
      $(".first").hide();
      $(".second").hide();
      $(".third").show();

      let x = $("#inlineFormInputGroup").val();

      if (x === NaN || x === "" || x <= 0) {
        $("#enterANumber").show();
        $(".third").hide();
        $(".second").show();
      } else {
        answers.push(x);
      }
    });

    $(".btn-equip").click(function (event) {
      event.preventDefault();
      $(".first").hide();
      $(".second").hide();
      $(".third").hide();
      $(".fourth").show();

      let atLeastOneIsChecked = $("input:checkbox").is(":checked");

      let bodyweight = $('input[name="bodyweight"]:checked').serialize();
      let dumbbell = $('input[name="dumbbell"]:checked').serialize();
      let barbell = $('input[name="barbell"]:checked').serialize();
      let cableMachine = $('input[name="cable/machine"]:checked').serialize();

      if (atLeastOneIsChecked === true) {
        if (bodyweight != "") {
          equipmentAnswers.push("bodyweight");
        }
        if (dumbbell != "") {
          equipmentAnswers.push("dumbbell");
        }
        if (barbell != "") {
          equipmentAnswers.push("barbell");
        }
        if (cableMachine != "") {
          equipmentAnswers.push("cable/machine");
        }
      } else {
        $("#selectAtLeastOne").show();
        $(".fourth").hide();
        $(".third").show();
      }
    });

    $(".btn-level").click(function (event) {
      event.preventDefault();
      $(".first").hide();
      $(".second").hide();
      $(".third").hide();
      $(".fourth").hide();
      $(".fifth").show();
      // console.log(this.innerText);
      answers.push(this.innerText);
      // console.log(answers);
    })

    $(".btn-muscle").click(function (event) {
      event.preventDefault();
      $(".first").hide();
      $(".second").hide();
      $(".third").hide();
      $(".fourth").hide();
      $(".fifth").hide();
      $(".sixth").show();

      let chest = $('input[name="chest"]:checked').serialize();
      let back = $('input[name="back"]:checked').serialize();
      let legs = $('input[name="legs"]:checked').serialize();
      let shoulders = $('input[name="shoulders"]:checked').serialize();
      let biceps = $('input[name="biceps"]:checked').serialize();
      let triceps = $('input[name="triceps"]:checked').serialize();
      let abs = $('input[name="abs"]:checked').serialize();

      let atLeastOneIsChecked = $("input:checked").length;
      // console.log(atLeastOneIsChecked);

      if (atLeastOneIsChecked > 1) {
        if (chest != "") {
          muscleAnswers.push("chest");
        }
        if (back != "") {
          muscleAnswers.push("back");
        }
        if (legs != "") {
          muscleAnswers.push("legs");
        }
        if (shoulders != "") {
          muscleAnswers.push("shoulders");
        }
        if (biceps != "") {
          muscleAnswers.push("biceps");
        }
        if (triceps != "") {
          muscleAnswers.push("triceps");
        }
        if (abs != "") {
          muscleAnswers.push("abs");
        }

      } else {
        $("#selectAtLeastOneMuscle").show();
        $(".sixth").hide();
        $(".fifth").show();

      }
    });

    function updateUser() {
      // console.log({
      //   gender: answers[0],
      //   level: answers[3],
      //   weight: answers[1]
      // });

      $.ajax({
        method: "PUT",
        url: "/api/user_data",
        data: {
          gender: answers[0],
          weight: answers[1],
          level: answers[2],
          muscle: muscleAnswers[0]
          // equipment: equipmentAnswers
        },
        success: function (data) {
          for (let i = 0; i < equipmentAnswers.length; i++) {
            $.ajax({
              method: "PUT",
              url: "/api/user_data",
              data: {
                equipment: equipmentAnswers[i]
              }
            })
          }
        }
      }).then(() => {
        window.location.href = './members.html';

      })
    }

    $(".btn-end").click(function (event) {
      event.preventDefault();
      updateUser();
    });

    $(".btn-muscle").click(event => {
      event.preventDefault();

      $.ajax({
        type: "GET",
        url: "/api/findExercises",
        data: {
          level: answers[2],
          muscle: muscleAnswers[0],
          equipment: equipmentAnswers[0],
          equipment: equipmentAnswers[1]
          // ^this needs to be re-written to account for the equipment loop...
          // as in: this entire ajax request needs to be moved underneath the 
          // success of the equipment ajax
        }
      }).then(data => {
        console.log(data);
      })
    });

  </script>
</body>

</html>